---
layout: post
title: SICP Lecture 1A - Introduction to Lisp
---

<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<blockquote>
<p>
Computer science is a terrible name for this business&#x2026; it&rsquo;s not a science, it&rsquo;s also not really
very much about computers&#x2026;
</p>

<p>
&#x2014; Hal Abelson
</p>
</blockquote>

<p>
I&rsquo;ve decided that I should put lockdown to good use and work through <i>Structure and Interpretation of
Computer Programs</i>, following the book <a class='org-ref-reference' href="#Abelson1996">Abelson1996</a>, <a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-001-structure-and-interpretation-of-computer-programs-spring-2005/video-lectures/">video lecture series</a> and <a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-001-structure-and-interpretation-of-computer-programs-spring-2005/lecture-notes/">MIT-OCW lecture
notes</a>.
<a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-001-structure-and-interpretation-of-computer-programs-spring-2005/video-lectures/1a-overview-and-introduction-to-lisp">Lecture 1A</a> of the video introduces the course before introducing the Scheme dialect of Lisp,
corresponding to book ยง1.1.1 and MIT-OCW lectures 1 and 2.
</p>

<div id="outline-container-org6c20726" class="outline-2">
<h2 id="org6c20726"><span class="section-number-2">1</span> Overview</h2>
<div class="outline-text-2" id="text-1">
<p>
Computer science is concerned with the study of <i>processes</i>, abstract concepts that manipulate and
transform data, and a formalism for their analysis.
To execute a process a set of instructions is required, this <i>imperative</i> or &ldquo;how to&rdquo; knowledge is
written down in a <i>procedure</i> and programming languages provide a way to precisely specify
procedures.
This is in contrast with <i>declarative</i> &ldquo;what is&rdquo; knowledge, such as
</p>
\begin{equation}
  y=\sqrt{x}\ \mbox{is the } y\ \mbox{such that } y^2=x
\end{equation}
<p>
defining <i>what</i> a square root is, whereas Heron&rsquo;s method
</p>
\begin{align}
  \mbox{While } \left| y^2_n - x \right| &> \varepsilon \\
  y_{n+1} &= \frac{y_n + x/y_n}{2}
\end{align}
<p>
describes <i>how</i> to compute a square root.
</p>

<p>
The goal in analysing processes and the procedures that define them is to be able to design, build
and understand large, complex systems in order to achieve <i>something</i>.
Achieving some task may be sufficient, however many problems are so large and costly that the
process evolved by a na&iuml;ve solution may be impractical to the point of being useless, by developing
tools to study procedures and the processes they yield, computer science atleast makes approaching
such problems possible.
Complexity arises in computer science as a result of the complexity inherent in the system being
modelled.
This is in contrast to physical systems which must work with <i>real</i> components, in computer science
they are built from <i>idealised</i> components about which we know everything
</p>
<blockquote>
<p>
the constraints imposed&#x2026; are the limits of our own minds.
</p>

<p>
&#x2014; Hal Abelson
</p>
</blockquote>
<p>
As these systems grow larger it becomes necessary to suppress and control the complexity, only by
developing these means of controlling complexity is it possible to study the processes controlling
these systems.
</p>
</div>

<div id="outline-container-orgb945a98" class="outline-3">
<h3 id="orgb945a98"><span class="section-number-3">1.1</span> Methods of abstraction</h3>
<div class="outline-text-3" id="text-1-1">
<p>
In SICP, and in some sense computer science, the focus is on developing and applying methods of
abstraction as a core technique in computer science for <i>suppressing detail</i> and controlling
complexity in order to be better able to design and study procedures and the processes they yield.
Three major techniques will be explored:
</p>
<ol class="org-ol">
<li><p>
<b>Black box abstraction</b> - the idea of taking some complexity and placing the details in a <i>named</i> box
such that the details needn&rsquo;t be understood, <i>e.g.</i> given a procedure for computing square roots
called <code>SQRT</code> it can be used as
</p>
\begin{equation}
  x \rightarrow SQRT \rightarrow y=\sqrt{x}
\end{equation}
<p>
the details of how to compute a square root are suppressed within the <code>SQRT</code> routine, for the user
they don&rsquo;t matter.
</p></li>
<li><b>Conventional interfaces</b> - provide agreed upon ways to plug things together such as <i>generic
operations</i> allowing <code>(* x (+ a1 a2))</code> to be applied to numbers, vectors, signals, <i>etc.</i></li>
<li><b>Metalinguistic abstraction</b> - developing a <i>new</i> language that is better suited to describing the
problem at hand helps suppress complexity</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org1cf0044" class="outline-2">
<h2 id="org1cf0044"><span class="section-number-2">2</span> Introduction to Lisp</h2>
<div class="outline-text-2" id="text-2">
<p>
As stated in &sect;<a href="#org6c20726">1</a> a programming language is really a way to communicate ideas about processes
by writing down procedures; in SICP this is done using the Scheme dialect of Lisp, I&rsquo;ll be using
<a href="https://www.gnu.org/software/guile/">Guile Scheme</a>.
In approaching a new programming language, Hal Abelson says:
</p>
<blockquote>
<p>
you don&rsquo;t say, how many characters does it take to invert a matrix?
It&rsquo;s irrelevant.
What you say is, if the language did not come with matrices built in or something else built in, how
could I then build that thing?
</p>

<p>
&#x2014; Hal Abelson
</p>
</blockquote>
</div>

<div id="outline-container-orgb6be39c" class="outline-3">
<h3 id="orgb6be39c"><span class="section-number-3">2.1</span> Elements of a programming language</h3>
<div class="outline-text-3" id="text-2-1">
<p>
The elements of a programming language that make it useful for expressing these ideas are its <a href="#orgef95853">primitive elements</a>, <a href="#org882d709">means of combination</a> and <a href="#org0303415">means of abstraction</a>.
</p>
</div>

<div id="outline-container-orgef95853" class="outline-4">
<h4 id="orgef95853"><span class="section-number-4">2.1.1</span> Primitive elements</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
The primitive elements of a programming language are the data and procedures that are &ldquo;built in&rdquo; to
a system, they are themselves a form of <i>abstraction</i> over low level details.
For example the symbol <code>3</code> represents the number three, which in terms of binary bits would be
implemented as <code>0000 0011</code>, the symbol however is generally much easier to work with; likewise, the
symbol <code>+</code> represents a procedure for performing addition.
In Lisp evaluating a primitive expression simply returns its value, either the number \(3\) or the
addition procedure in the above examples; by convention, all expressions in Lisp return a value.
</p>
</div>
</div>

<div id="outline-container-org882d709" class="outline-4">
<h4 id="org882d709"><span class="section-number-4">2.1.2</span> Means of combination</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
Means of combination enable forming <i>compound</i> elements, in Lisp this achieved by <i>combinations</i> which,
using a parenthesised list of terms interpreted following a prefix notation to represent <i>application</i>
of a procedure to some arguments, <i>e.g.</i>
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #4f97d7;">(</span>+ 3 17.4 5<span style="color: #4f97d7;">)</span>
</pre>
</div>
<p>
the first term is the <i>operator</i> and subsequent terms the <i>operands</i>.
Evaluating a combination evaluates the operator and operands, returning their values as a procedure
and arguments to which the procedure is applied, respectively, the result of the procedure is
returned as the value of the combination.
By using parenthesised prefix notation it is possible to give the operator an arbitrary length list
of operands, and also to <i>nest</i> combinations unambiguously such as
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #4f97d7;">(</span>+ 3 <span style="color: #bc6ec5;">(</span>* 5 7<span style="color: #bc6ec5;">)</span> 8 2<span style="color: #4f97d7;">)</span>
</pre>
</div>
<p>
This can be seen as a notation for tress of procedures and their arguments, with values accumulating
up to the root node to be returned as the value of the evaluated combination.
</p>
</div>
</div>

<div id="outline-container-org0303415" class="outline-4">
<h4 id="org0303415"><span class="section-number-4">2.1.3</span> Means of abstraction</h4>
<div class="outline-text-4" id="text-2-1-3">
<p>
Means of combination allow for expressing compound data or procedures, however without being able to
associate a name to them they would have to be written out in full each time they are used.
The ability to name something enables abstraction by putting the object in a box whose name (if well
chosen) tells you what it is, for example in Lisp (specifically Scheme) the area of a
circle of radius 5 could be abstracted as in listing&nbsp;<a href="#org875e567">1</a>, subsequently evaluating
the variable <code>a</code> would return the area of the circle as its value.
The <code>define</code> <i><a href="#org4c0cf42">special form</a></i> associates the <i>name</i> given as its first argument with the <i>value</i> given
by evaluating its second argument, returning this name-value pairing as a <i>variable</i> - the name is not
evaluated otherwise the created variable would not be named as expected!
This name-value pairing is stored in the environment, essentially a table of name-value pairs (at
the top-level this is the <i>global environment</i>).
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>Creating a new variable in Scheme to store the area of a circle</label><pre class="src src-scheme" id="org875e567"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5; font-weight: bold;">a</span> <span style="color: #bc6ec5;">(</span>* 3.14 <span style="color: #2d9574;">(</span>* 5 5<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>

<div id="outline-container-org4d03475" class="outline-5">
<h5 id="org4d03475"><span class="section-number-5">2.1.3.1</span> Creating procedures</h5>
<div class="outline-text-5" id="text-2-1-3-1">
<p>
More powerful still is to capture the <i>idea</i> of how to compute a circle&rsquo;s area in a procedure, rather
than store the area of every possible circle.
Listing&nbsp;<a href="#orgf1c37e5">2</a> shows how this can be done in Scheme; this actually makes use of some
<i>syntactic sugar</i>, explained below.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 2: </span>Creating a procedure in Scheme to compute the area of a circle</label><pre class="src src-scheme" id="orgf1c37e5"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">circle-area</span> r<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>* 3.14 <span style="color: #2d9574;">(</span>* r r<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>

<p>
What is actually happening in listing&nbsp;<a href="#orgf1c37e5">2</a> is a procedure is being created as the
object to be paired with the name given in the first operand - a list of the procedure name and its
<i>formal parameters</i> - this is made more clear by the equivalent definition given in
listing&nbsp;<a href="#org032bc37">3</a>, where the <code>lambda</code> special form is Lisp&rsquo;s method for creating
procedures following the syntax shown in listing&nbsp;<a href="#orgdc083f9">4</a>.
Evaluating a <code>lambda</code> <a href="#org4c0cf42">special form</a> <i>returns a procedure as its value</i>, neither the formal parameters nor
the body are evaluated at this time; crucially these user-defined procedures are <i>indistinguishable</i>
from built-in procedures.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 3: </span>Explicitly naming a procedure in Scheme to compute the area of a circle</label><pre class="src src-scheme" id="org032bc37"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5; font-weight: bold;">circle-area</span> <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">lambda</span> <span style="color: #2d9574;">(</span>r<span style="color: #2d9574;">)</span>
                      <span style="color: #2d9574;">(</span>* 3.14 <span style="color: #67b11d;">(</span>* r r<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 4: </span>The syntax of the <code>lambda</code> special form.</label><pre class="src src-scheme" id="orgdc083f9"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">lambda</span> <span style="color: #bc6ec5;">(</span>&lt;formal parameters&gt;<span style="color: #bc6ec5;">)</span>
  <span style="color: #ce537a; font-weight: bold;">&lt;body&gt;</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org4c0cf42" class="outline-4">
<h4 id="org4c0cf42"><span class="section-number-4">2.1.4</span> Special forms</h4>
<div class="outline-text-4" id="text-2-1-4">
<p>
Special forms do not follow the usual evaluation rules for combinations, rather they follow their
own specific rules such as the <code>define</code> and <code>lambda</code> forms introduced above.
</p>
</div>
</div>

<div id="outline-container-org1002b10" class="outline-4">
<h4 id="org1002b10"><span class="section-number-4">2.1.5</span> Case analysis</h4>
<div class="outline-text-4" id="text-2-1-5">
<p>
Case analysis enables testing a condition by evaluating a <i>predicate</i> and performing different actions
(the <i>consequent</i> or <i>alternate</i>) based on the truth value of the predicate, typically this takes the form of
an <code>if-then-else</code>, such as
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #bc6ec5;">(</span><span style="color: #ce537a; font-weight: bold;">&lt;predicate&gt;</span><span style="color: #bc6ec5;">)</span>
    <span style="color: #ce537a; font-weight: bold;">&lt;consequent&gt;</span>
    <span style="color: #ce537a; font-weight: bold;">&lt;alternate&gt;</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
<p>
if the predicate evaluates as true, the <code>if</code> returns the consequent expression as its value, otherwise
the alternate expression is returned.
Multiple conditions may be tested in an <code>if-elseif-else</code> form, expressed in Lisp using <code>cond</code>
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span> <span style="color: #bc6ec5;">(</span><span style="color: #ce537a; font-weight: bold;">&lt;predicate-1&gt;</span>
       <span style="color: #ce537a; font-weight: bold;">&lt;body-1&gt;</span><span style="color: #bc6ec5;">)</span>
      <span style="color: #bc6ec5;">(</span><span style="color: #ce537a; font-weight: bold;">&lt;predicate-2&gt;</span>
       <span style="color: #ce537a; font-weight: bold;">&lt;body-2&gt;</span><span style="color: #bc6ec5;">)</span>
      ...
      <span style="color: #bc6ec5;">(</span><span style="color: #ce537a; font-weight: bold;">&lt;predicate-n&gt;</span>
       <span style="color: #ce537a; font-weight: bold;">&lt;body-n&gt;</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
<p>
From the discussion above, it is clear that <code>if</code> and <code>cond</code> are both <a href="#org4c0cf42">special forms</a>, only the body
returned by a true predicate is evaluated.
</p>

<p>
Without case analysis the procedures that may be defined are relatively limited, with case analysis
it becomes possible to develop much more complex procedures.
</p>
</div>
</div>

<div id="outline-container-orgf2939c0" class="outline-4">
<h4 id="orgf2939c0"><span class="section-number-4">2.1.6</span> Recursive procedures and looping</h4>
<div class="outline-text-4" id="text-2-1-6">
<p>
A procedure might be defined in terms of itself as a form of looping, <i>e.g.</i>
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">infinite-loop</span><span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>inifinite-loop<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
<p>
will call itself in an infinite loop - not very useful!
Using case analysis enables testing a stopping condition which, when met, ends the loop and returns
the result.
As an example application, counting to \(n\) could be implemented as
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">count</span> n<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>count-iter 0 n<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">count-iter</span> s n<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #2d9574;">(</span>= 0 n<span style="color: #2d9574;">)</span>
      s
      <span style="color: #2d9574;">(</span>count-iter <span style="color: #67b11d;">(</span>1+ s<span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>1- n<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org1881c30" class="outline-2">
<h2 id="org1881c30"><span class="section-number-2">3</span> Black box abstraction</h2>
<div class="outline-text-2" id="text-3">
<p>
Black box abstraction encapsulates complexity in a box, <a href="#org0303415">hiding it behind a name</a>, the contents of
which needn&rsquo;t be understood to make use of it, simply it is expected to perform some particular task
such as providing a value for &pi; or <i>e.g.</i> given a procedure <code>SQRT</code> for computing square roots, we expect
it to behave as
</p>
\begin{equation}
  x \rightarrow SQRT \rightarrow y=\sqrt{x} \ ,
\end{equation}
<p>
<i>how</i> it computes the square root doesn&rsquo;t matter.
Once defined black boxes can be treated as primitive and combined to form larger, more complex black
boxes, raising the level of abstraction; this process can be continued at the new level of
abstraction and so on to build large, complex systems from smaller components.
</p>
</div>

<div id="outline-container-orgc2448be" class="outline-3">
<h3 id="orgc2448be"><span class="section-number-3">3.1</span> Procedural abstraction</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Black box abstractions facilitate building large complex systems from smaller components which
<i>modularise</i> common ideas.
For instance, to compute the area of a circle you square the radius and multiply this by &pi;, a
straightforward definition of this procedure was given previously in listing&nbsp;<a href="#org875e567">1</a>.
Whilst such a straightforward procedure is easy to understand, it doesn&rsquo;t <i>express</i> clearly what is
being done, listing&nbsp;<a href="#org471e7d1">5</a> demonstrates a better approach based on <i>procedural
abstraction</i> to replace the action of squaring a number with a procedure that achieves the same,
given in listing&nbsp;<a href="#org918e4e5">6</a>.
The result is a procedure that is easier to understand because the implementation details of how to
square a number have been suppressed by the <code>square</code> abstraction, from the perspective of <code>circle-area</code>
any procedure that computes the square is equally good and by abstracting away the squaring process
it becomes possible to replace it with a more efficient implementation without changing the
definition of <code>circle-area</code><sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 5: </span>Computing the area of a circle using procedural abstraction</label><pre class="src src-scheme" id="org471e7d1">
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">circle-area</span> r<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>* 3.14 <span style="color: #2d9574;">(</span>square r<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 6: </span>Procedure for squaring a number</label><pre class="src src-scheme" id="org918e4e5"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">square</span> x<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>* x x<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>

<div id="outline-container-org4ab3e5d" class="outline-4">
<h4 id="org4ab3e5d"><span class="section-number-4">3.1.1</span> A procedure for procedural abstraction</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
Listing&nbsp;<a href="#org471e7d1">5</a> demonstrates the application of procedural abstraction to the
original procedure definition given in listing&nbsp;<a href="#org875e567">1</a>, improving its legibility by
capturing the concept of <i>squaring things</i> in the <code>square</code> procedure (which can likely be reused
elsewhere) and suppressing the detail of its implementation in an abstraction.
</p>

<p>
Procedural abstraction can be achieved by applying a relatively straightforward procedure:
</p>
<ol class="org-ol">
<li>Identify sub=tasks within the computational process, these can be isolated as <i>modules</i></li>
<li>Develop a <i>procedural abstraction</i> for each module</li>
<li>Create a procedure to direct the interaction of these modules through their procedural
abstractions</li>
<li>Apply steps 1-3 to each identified module</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org99490f5" class="outline-3">
<h3 id="org99490f5"><span class="section-number-3">3.2</span> Block structuring</h3>
<div class="outline-text-3" id="text-3-2">
<p>
When building a complex procedure making use of procedural abstraction, the names given for some or
all of the modules may express concepts that are of wider use, but whose details are specific to the
procedure at hand.
To illustrate this consider the implementation of Heron&rsquo;s method in listing&nbsp;<a href="#org4a53481">7</a>,
the concepts of testing if a guess is good enough, or improving a guess would equally be applicable
to a related procedure for finding cube roots, however an implementer of this procedure would have
to find new names for these sub-procedures.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 7: </span>An implementation of Heron&rsquo;s method</label><pre class="src src-scheme" id="org4a53481"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">herons-root</span> x<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>try 1.0 x<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">try</span> guess x<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #2d9574;">(</span>good-enough? guess x<span style="color: #2d9574;">)</span>
      guess
      <span style="color: #2d9574;">(</span>try <span style="color: #67b11d;">(</span>improve-guess guess x<span style="color: #67b11d;">)</span> x<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">good-enough?</span> guess x<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>&lt; <span style="color: #2d9574;">(</span>abs <span style="color: #67b11d;">(</span>- <span style="color: #b1951d;">(</span>square guess<span style="color: #b1951d;">)</span> x<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
     0.001<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">improve-guess</span> guess x<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>/ <span style="color: #2d9574;">(</span>+ guess <span style="color: #67b11d;">(</span>/ x guess<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
     2<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>

<p>
It would be better if procedural abstractions specific to a particular procedure did not pollute the
namespace and therefore affect the work of others.
This can be achieved by <i>block structuring</i> the code, defining sub-modules as part of the definition
of the procedure being developed as shown in listing&nbsp;<a href="#orgb69d91e">8</a>.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 8: </span>A block-structured implemenation of Heron&rsquo;s method</label><pre class="src src-scheme" id="orgb69d91e"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">herons-root-blockstruct</span> x<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #2d9574;">(</span><span style="color: #bc6ec5; font-weight: bold;">good-enough?</span> guess<span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>&lt; <span style="color: #67b11d;">(</span>abs <span style="color: #b1951d;">(</span>- <span style="color: #4f97d7;">(</span>square guess<span style="color: #4f97d7;">)</span> x<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
       0.001<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #2d9574;">(</span><span style="color: #bc6ec5; font-weight: bold;">improve-guess</span> guess<span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>/ <span style="color: #67b11d;">(</span>+ guess <span style="color: #b1951d;">(</span>/ x guess<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
       2<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #2d9574;">(</span><span style="color: #bc6ec5; font-weight: bold;">try</span> guess<span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #67b11d;">(</span>good-enough? guess<span style="color: #67b11d;">)</span>
        guess
        <span style="color: #67b11d;">(</span>try <span style="color: #b1951d;">(</span>improve-guess guess<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>try 1.0<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>

<p>
If the language is <i>lexically scoped</i> (as most Lisps are), this can also simplify the implementation
of sub-modules, as shown in listing&nbsp;<a href="#orgb69d91e">8</a> <code>x</code> needn&rsquo;t be passed to them, rather it
is left as a free variable and takes its value from the enclosing scope of <code>herons-root</code>; note that
<code>square</code> is a procedural abstraction of a general concept and so is assumed to be defined somewhere
externally to <code>herons-root</code>.
</p>
</div>
</div>
</div>

<div id="outline-container-org6477e22" class="outline-2">
<h2 id="org6477e22"><span class="section-number-2">4</span> Exercises</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org8874779" class="outline-3">
<h3 id="org8874779"><span class="section-number-3">4.1</span> Exercise 1.1</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Asks what are the values returned by several expressions shown as comments in the code block below.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 9: </span>Solution to exercise 1.1</label><pre class="src src-scheme">10
                                        <span style="color: #2aa1ae; background-color: #292e34;">; </span><span style="color: #2aa1ae; background-color: #292e34;">10</span>
<span style="color: #4f97d7;">(</span>+ 5 3 4<span style="color: #4f97d7;">)</span>
                                        <span style="color: #2aa1ae; background-color: #292e34;">; </span><span style="color: #2aa1ae; background-color: #292e34;">12</span>
<span style="color: #4f97d7;">(</span>- 9 1<span style="color: #4f97d7;">)</span>
                                        <span style="color: #2aa1ae; background-color: #292e34;">; </span><span style="color: #2aa1ae; background-color: #292e34;">8</span>
<span style="color: #4f97d7;">(</span>/ 6 2<span style="color: #4f97d7;">)</span>
                                        <span style="color: #2aa1ae; background-color: #292e34;">; </span><span style="color: #2aa1ae; background-color: #292e34;">3</span>
<span style="color: #4f97d7;">(</span>+ <span style="color: #bc6ec5;">(</span>* 2 4<span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">(</span>- 4 6<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
                                        <span style="color: #2aa1ae; background-color: #292e34;">; </span><span style="color: #2aa1ae; background-color: #292e34;">6</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5; font-weight: bold;">a</span> 3<span style="color: #4f97d7;">)</span>
                                        <span style="color: #2aa1ae; background-color: #292e34;">; </span><span style="color: #2aa1ae; background-color: #292e34;">a</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5; font-weight: bold;">b</span> <span style="color: #bc6ec5;">(</span>+ a 1<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
                                        <span style="color: #2aa1ae; background-color: #292e34;">; </span><span style="color: #2aa1ae; background-color: #292e34;">b</span>
<span style="color: #4f97d7;">(</span>+ a b <span style="color: #bc6ec5;">(</span>* a b<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
                                        <span style="color: #2aa1ae; background-color: #292e34;">; </span><span style="color: #2aa1ae; background-color: #292e34;">19</span>
<span style="color: #4f97d7;">(</span>= a b<span style="color: #4f97d7;">)</span>
                                        <span style="color: #2aa1ae; background-color: #292e34;">; </span><span style="color: #2aa1ae; background-color: #292e34;">#f</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">and</span> <span style="color: #2d9574;">(</span>&gt; b a<span style="color: #2d9574;">)</span>
         <span style="color: #2d9574;">(</span>&lt; b <span style="color: #67b11d;">(</span>* a b<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
    b
    a<span style="color: #4f97d7;">)</span>
                                        <span style="color: #2aa1ae; background-color: #292e34;">; </span><span style="color: #2aa1ae; background-color: #292e34;">4</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span> <span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">(</span>= a 4<span style="color: #2d9574;">)</span>
       6<span style="color: #bc6ec5;">)</span>
      <span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">(</span>= b 4<span style="color: #2d9574;">)</span>
       <span style="color: #2d9574;">(</span>+ 6 7 a<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
      <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">else</span>
       25<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
                                        <span style="color: #2aa1ae; background-color: #292e34;">; </span><span style="color: #2aa1ae; background-color: #292e34;">16</span>
<span style="color: #4f97d7;">(</span>+ 2 <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #2d9574;">(</span>&gt; b a<span style="color: #2d9574;">)</span>
         b
         a<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
                                        <span style="color: #2aa1ae; background-color: #292e34;">; </span><span style="color: #2aa1ae; background-color: #292e34;">6</span>
<span style="color: #4f97d7;">(</span>* <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span> <span style="color: #2d9574;">(</span><span style="color: #67b11d;">(</span>&gt; a b<span style="color: #67b11d;">)</span>
          a<span style="color: #2d9574;">)</span>
         <span style="color: #2d9574;">(</span><span style="color: #67b11d;">(</span>&lt; a b<span style="color: #67b11d;">)</span>
          b<span style="color: #2d9574;">)</span>
         <span style="color: #2d9574;">(</span><span style="color: #4f97d7; font-weight: bold;">else</span>
          -1<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
   <span style="color: #bc6ec5;">(</span>+ a 1<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
                                        <span style="color: #2aa1ae; background-color: #292e34;">; </span><span style="color: #2aa1ae; background-color: #292e34;">16</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd73cd99" class="outline-3">
<h3 id="orgd73cd99"><span class="section-number-3">4.2</span> Exercise 1.2</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Translate
</p>
\begin{equation}
  \frac{5 + 4 + \left( 2 - \left( 3 - \left( 6 + 4/5 \right) \right) \right)}{3 \left( 6 - 2 \right)
  \left( 2 - 7 \right)}
\end{equation}
<p>
into prefix form.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 10: </span>Solution to exercise 1.2</label><pre class="src src-scheme"><span style="color: #4f97d7;">(</span>/ <span style="color: #bc6ec5;">(</span>+ 5 4 <span style="color: #2d9574;">(</span>- 2 <span style="color: #67b11d;">(</span>- 3 <span style="color: #b1951d;">(</span>+ 6 <span style="color: #4f97d7;">(</span>/ 4 5<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
   <span style="color: #bc6ec5;">(</span>* 3 <span style="color: #2d9574;">(</span>- 6 2<span style="color: #2d9574;">)</span> <span style="color: #2d9574;">(</span>- 2 7<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgee76c10" class="outline-3">
<h3 id="orgee76c10"><span class="section-number-3">4.3</span> Exercise 1.3</h3>
<div class="outline-text-3" id="text-4-3">
<p>
Define a procedure that takes three numbers as arguments and returns the sum of the squares of the
two larger numbers.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 11: </span>Solution to exercise 1.3</label><pre class="src src-scheme"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">sicp-1.3</span> a b c<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span> <span style="color: #2d9574;">(</span><span style="color: #67b11d;">(</span><span style="color: #4f97d7; font-weight: bold;">and</span> <span style="color: #b1951d;">(</span>&gt;= a b<span style="color: #b1951d;">)</span>
              <span style="color: #b1951d;">(</span>&gt;= b c<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
         <span style="color: #67b11d;">(</span>sum-of-squares a b<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
        <span style="color: #2d9574;">(</span><span style="color: #67b11d;">(</span><span style="color: #4f97d7; font-weight: bold;">and</span> <span style="color: #b1951d;">(</span>&gt; b a<span style="color: #b1951d;">)</span>
              <span style="color: #b1951d;">(</span>&gt; c a<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
         <span style="color: #67b11d;">(</span>sum-of-squares b c<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
        <span style="color: #2d9574;">(</span><span style="color: #4f97d7; font-weight: bold;">else</span>
         <span style="color: #67b11d;">(</span>sum-of-squares a c<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb7f8a04" class="outline-3">
<h3 id="orgb7f8a04"><span class="section-number-3">4.4</span> Exercise 1.4</h3>
<div class="outline-text-3" id="text-4-4">
<p>
The model of evaluation allows combinations whose operators are compound expressions, using this
observation described the behaviour of the following procedure:
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">a-plus-abs-b</span> a b<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #67b11d;">(</span>&gt; b 0<span style="color: #67b11d;">)</span>
       +
       -<span style="color: #2d9574;">)</span>
   a b<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>

<p>
Evaluating the procedure returned by <code>a-plus-abs-b</code>, the operator is obtained by evaluating the <code>if</code>
form, returning either the <code>+</code> or <code>-</code> symbol depending on the sign of <code>b</code>, this is then evaluated to
obtain the appropriate procedure which is applied to operands <code>a</code> and <code>b</code> with the result it returns
\(a+\left|b\right|\).
</p>
</div>
</div>
</div>

<div id="outline-container-orgd77a9e8" class="outline-2">
<h2 id="orgd77a9e8">References</h2>
<div class="outline-text-2" id="text-orgd77a9e8">
<p>

<ul class='org-ref-bib'><li><a id="Abelson1996">[Abelson1996]</a> <a name="Abelson1996"></a>Abelson, Sussman & Sussman, Structure and interpretation of computer programs, Justin Kelly (1996).</li>
</ul>
</p>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
This is a somewhat contrived example, but the principle applies in more complex scenarios. 
</p></div></div>


</div>
</div>
